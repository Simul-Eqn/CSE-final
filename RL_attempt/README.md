# Reproducibility Notes - RL Attempt 

## Additional setup 

There was a 'canopus' folder containing training data from CANOPUS, not commited to GitHub due to its large file size. It can be downloaded at this link: [https://drive.google.com/file/d/1e7dVIjO5AaG84Ct3xbwv3tzyWeMvU7Y8/view?ts=64c362e7] 
In addition to those, there are fragmentation trees to some samples, to be extracted and placed into the canopus folder under a subfolder "treeviews". It is downloadable at this link: [https://drive.google.com/file/d/1Z5nLH4RCyWBITao4-VR2oct_5oDVzska/view?usp=drive_link] 
Make sure that pytorch and dgl are both installed with CUDA, and that the other python libraries specified in requirements.txt are downloaded. 
Run file_structure.py under the folder RL_attempt to create the necessary directories. 


## Training the models 

To train the FTree GCN and main models, run train_mass_spec.py 
Then, run train_main_model.py to train the rest, selecting a FTree GCN model to use. (random seed reset to here) If you want to save the anomalous states chosen in testing, set save_chosen_anomalous_states to True in non_anomalous_path.py. It is set to False by default, as there are thousands of states, and it would take up >100MB of storage every 5 epochs. 


## Testing the FTree GCN 

To test the FTree GCN, run mass_spec_visualization.py 


## Plotting the main model's accuracy in detection 

To plot a histogram for the main model's accuracy in aomaly detection, to visualize its effectiveness in separating normal and anomalous states, run visualize_scores_anomaly.py 


## Testing the model's ability to generate molecules + generating related visualizations 

To test the main models' ability to search and generate the molecule from a starting state of only aromatic compounds, run the three similarly named programs test_full_search_main_models_max_12_filtered_0_1.py, test_full_search_main_models_max_12.py, and test_full_search_main_models_max_15.py, changing variables (e.g. the list epoch_nums, to choose which epochs of the main model to test) as desired. Then, run plot_full_search_main_models_results.py to see the visualization of the results. This was set to save states, useful to compare bond abundancies. 

To test the main models' accuracy in searching and generating the molecule from different depths, run the three similarly named programs test_depth_astar_search_max_12_filtered_0_1.py, test_depth_astar_search_max_12.py, and test_depth_astar_search_max_15.py, changing variables as desired. Then, run plot_depth_main_models_results.py to see the visualization of the results. 

Note that the subfolders try_2 and try_3 within figures/astar_\[case\]_results were manually created and images dragged into them, for ease of navigation. 


## Comparing the abundancies of types of bonds 

In the paper, there were values provided for the abundancies of single bonds in different scenarios. These were automatically generated by plot_astar_results.py and plot_astar_depths_results.py 


