import os
os.environ['DGLBACKEND'] = 'pytorch'

import dgl 
import torch 
import random 

import numpy as np 

seed = 10 

dgl.seed(seed) 
torch.manual_seed(seed)
random.seed(seed) 

device = torch.device("cuda" if torch.cuda.is_available() else "cpu") 


print("\nMASS SPEC TRAINING:")
import mass_spec_training 
mass_spec_training.device = device 
# search possible learning rates 
for gcn_lr in [8e-05, 0.0001, 0.00015]: 
    for predictor_lr in [8e-05, 0.0001, 0.00015]: 
        print() 
        print("SEARCHING: GCN_LR:",gcn_lr,"predictor_lr:",predictor_lr)
        mass_spec_training.path_prefix = './RL_attempt/mass_spec_lr_search/search_'+str(gcn_lr)+"_"+str(predictor_lr) 
        mass_spec_training.gcn_lr = gcn_lr 
        mass_spec_training.predictor_lr = predictor_lr 
        mass_spec_training.train() 